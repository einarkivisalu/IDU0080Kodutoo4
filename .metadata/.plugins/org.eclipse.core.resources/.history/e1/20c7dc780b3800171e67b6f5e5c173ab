
/**
 * Please modify this class to meet your needs
 * This class is not complete
 */

package ttu.idu0080.orderservice.orders;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;
import java.util.logging.Logger;
import javax.jws.WebMethod;
import javax.jws.WebParam;
import javax.jws.WebResult;
import javax.jws.WebService;
import javax.xml.bind.annotation.XmlSeeAlso;
import javax.xml.ws.Action;
import javax.xml.ws.RequestWrapper;
import javax.xml.ws.ResponseWrapper;

/**
 * This class was generated by Apache CXF 2.7.18
 * 2017-05-13T14:31:10.604+03:00
 * Generated source version: 2.7.18
 * 
 */

@javax.jws.WebService(
                      serviceName = "OrderServiceService",
                      portName = "OrderServicePort",
                      targetNamespace = "http://server.order.idu0080.ttu/",
                      wsdlLocation = "file:/C:/Users/Random/workspace4test2/OrderService/src/orders.wsdl",
                      endpointInterface = "ttu.idu0080.orderservice.orders.OrderService")
                      
public class OrderServiceImpl implements OrderService {

	private static final String DB_DRIVER = "org.postgresql.Driver";
    private static final String DB_CONNECTION = "jdbc:postgresql://localhost:5432/orders"; 
    private static final String DB_USER = "IDU0080";
	private static final String DB_PASSWORD = "IDU0080";
	
    private static final Logger LOG = Logger.getLogger(OrderServiceImpl.class.getName());

    /* (non-Javadoc)
     * @see ttu.idu0080.orderservice.orders.OrderService#getOrdersByCustomerId(int  customerId )*
     */
    public java.util.List<ttu.idu0080.orderservice.orders.Order> getOrdersByCustomerId(int customerId) { 
        LOG.info("Executing operation getOrdersByCustomerId");
        System.out.println(customerId);
        try {
            java.util.List<ttu.idu0080.orderservice.orders.Order> _return = new java.util.ArrayList<ttu.idu0080.orderservice.orders.Order>();
            ttu.idu0080.orderservice.orders.Order _returnVal1 = new ttu.idu0080.orderservice.orders.Order();
            ttu.idu0080.orderservice.orders.Customer _returnVal1Customer = new ttu.idu0080.orderservice.orders.Customer();
            java.util.List<ttu.idu0080.orderservice.orders.Address> _returnVal1CustomerAddresses = new java.util.ArrayList<ttu.idu0080.orderservice.orders.Address>();
            _returnVal1Customer.getAddresses().addAll(_returnVal1CustomerAddresses);
            _returnVal1Customer.setCustomer(1536253918);
            _returnVal1Customer.setFirstName("FirstName1770798415");
            _returnVal1Customer.setLastName("LastName333947044");
            _returnVal1.setCustomer(_returnVal1Customer);
            _returnVal1.setOrderId(1461797492);
            java.util.List<ttu.idu0080.orderservice.orders.OrderProduct> _returnVal1OrderProducts = new java.util.ArrayList<ttu.idu0080.orderservice.orders.OrderProduct>();
            ttu.idu0080.orderservice.orders.OrderProduct _returnVal1OrderProductsVal1 = new ttu.idu0080.orderservice.orders.OrderProduct();
            _returnVal1OrderProductsVal1.setOrderProduct(3387647);
            _returnVal1OrderProductsVal1.setPrice(0.25234264f);
            _returnVal1OrderProductsVal1.setPriceTotal(0.36205417f);
            _returnVal1OrderProductsVal1.setProductCount(-217245623);
            _returnVal1OrderProductsVal1.setProductName("ProductName2121140788");
            _returnVal1OrderProducts.add(_returnVal1OrderProductsVal1);
            _returnVal1.getOrderProducts().addAll(_returnVal1OrderProducts);
            _returnVal1.setPriceTotal(0.58579195f);
            ttu.idu0080.orderservice.orders.Seller _returnVal1Seller = new ttu.idu0080.orderservice.orders.Seller();
            java.util.List<ttu.idu0080.orderservice.orders.EntAddress> _returnVal1SellerAddresses = new java.util.ArrayList<ttu.idu0080.orderservice.orders.EntAddress>();
            _returnVal1Seller.getAddresses().addAll(_returnVal1SellerAddresses);
            _returnVal1Seller.setEnterprise(1122515728);
            _returnVal1Seller.setName("Name-144568752");
            _returnVal1.setSeller(_returnVal1Seller);
            ttu.idu0080.orderservice.orders.Address _returnVal1ShippingAddress = new ttu.idu0080.orderservice.orders.Address();
            _returnVal1ShippingAddress.setAddress(-1436705981);
            _returnVal1ShippingAddress.setCountry("Country-367848412");
            _returnVal1ShippingAddress.setCounty("County-619095096");
            _returnVal1ShippingAddress.setStreetAddress("StreetAddress1727785447");
            _returnVal1ShippingAddress.setTownVillage("TownVillage-446341956");
            _returnVal1ShippingAddress.setZipcode("Zipcode306735356");
            _returnVal1.setShippingAddress(_returnVal1ShippingAddress);
            _return.add(_returnVal1);
            return _return;
        } catch (java.lang.Exception ex) {
            ex.printStackTrace();
            throw new RuntimeException(ex);
        }
    }

    /* (non-Javadoc)
     * @see ttu.idu0080.orderservice.orders.OrderService#getAllOrders(*
     */
    public java.util.List<ttu.idu0080.orderservice.orders.Order> getAllOrders() { 
        LOG.info("Executing operation getAllOrders");
        try {
            java.util.List<ttu.idu0080.orderservice.orders.Order> _return = new java.util.ArrayList<ttu.idu0080.orderservice.orders.Order>();

        	Class.forName(DB_DRIVER);
        	Connection connection = DriverManager.getConnection(DB_CONNECTION, DB_USER, DB_PASSWORD);
            
            String sql = "SELECT * FROM eshop_order";
            Statement stmt = connection.createStatement();
            ResultSet rs = stmt.executeQuery(sql);
            
            while (rs.next()) {
                ttu.idu0080.orderservice.orders.Order _returnVal1 = new ttu.idu0080.orderservice.orders.Order();
                
                
                // lisa üldinfo
                int order_id = rs.getInt("eshop_order");
                int seller_id = rs.getInt("seller_fk");
                int ship_id = rs.getInt("shipping_address_fk");
               _returnVal1.setOrderId(order_id);
               _returnVal1.setPriceTotal(rs.getFloat("price_total"));
                
                // lisa kasutajainfo
                int user_id = rs.getInt("customer_fk");
                System.out.printf("%d\n", user_id );
                
//                sql = "SELECT customer, first_name, last_name FROM customer WHERE customer=" + user_id;
                sql = "SELECT * FROM customer WHERE customer=" + user_id;
                Statement stmt2 = connection.createStatement();
                ResultSet rs2 = stmt2.executeQuery(sql);
                
                ttu.idu0080.orderservice.orders.Customer _returnVal1Customer = new ttu.idu0080.orderservice.orders.Customer();
                while (rs2.next()) {
	                _returnVal1Customer.setCustomer(rs2.getInt("customer"));
	                _returnVal1Customer.setFirstName(rs2.getString("first_name"));
	                _returnVal1Customer.setLastName(rs2.getString("last_name"));
                }
                
                // lisa kasutaja aadressid 
                java.util.List<ttu.idu0080.orderservice.orders.Address> _returnVal1CustomerAddresses = new java.util.ArrayList<ttu.idu0080.orderservice.orders.Address>();
                sql = "SELECT * FROM address WHERE subject_fk=" + user_id;
                rs2 = stmt2.executeQuery(sql);
                while (rs2.next()) {
                	ttu.idu0080.orderservice.orders.Address _CustomerAddress = new ttu.idu0080.orderservice.orders.Address();
                	_CustomerAddress.setAddress(rs2.getInt("address"));
                	_CustomerAddress.setCountry(rs2.getString("country"));
                	_CustomerAddress.setCounty(rs2.getString("county"));
                	_CustomerAddress.setStreetAddress(rs2.getString("street_address"));
                	_CustomerAddress.setTownVillage(rs2.getString("town_village"));
                	_CustomerAddress.setZipcode(rs2.getString("zipcode"));
                	_returnVal1CustomerAddresses.add(_CustomerAddress);
                }
                _returnVal1Customer.getAddresses().addAll(_returnVal1CustomerAddresses);
                _returnVal1.setCustomer(_returnVal1Customer);
                System.out.printf("3\n");
                
                // lisa toote info
                sql = "SELECT * FROM order_product WHERE eshop_order_fk=" + order_id;
                rs2 = stmt2.executeQuery(sql);
                
                java.util.List<ttu.idu0080.orderservice.orders.OrderProduct> _returnVal1OrderProducts = new java.util.ArrayList<ttu.idu0080.orderservice.orders.OrderProduct>();
                while (rs2.next()) {
	                ttu.idu0080.orderservice.orders.OrderProduct _returnVal1OrderProductsVal1 = new ttu.idu0080.orderservice.orders.OrderProduct();
	                _returnVal1OrderProductsVal1.setOrderProduct(rs2.getInt("order_product"));
	                _returnVal1OrderProductsVal1.setPrice(rs2.getFloat("price"));
	                _returnVal1OrderProductsVal1.setPriceTotal(rs2.getFloat("price_total"));
	                _returnVal1OrderProductsVal1.setProductCount(rs2.getInt("product_count"));
	                _returnVal1OrderProductsVal1.setProductName(rs2.getString("product_name"));
	                _returnVal1OrderProducts.add(_returnVal1OrderProductsVal1);
                }
                _returnVal1.getOrderProducts().addAll(_returnVal1OrderProducts);
                
                System.out.printf("4\n");
                // müüja info 
                ttu.idu0080.orderservice.orders.Seller _returnVal1Seller = new ttu.idu0080.orderservice.orders.Seller();
                java.util.List<ttu.idu0080.orderservice.orders.EntAddress> _returnVal1SellerAddresses = new java.util.ArrayList<ttu.idu0080.orderservice.orders.EntAddress>();

                sql = "SELECT full_name FROM enterprise WHERE enterprise=" + seller_id;
                rs2 = stmt2.executeQuery(sql);
                System.out.printf("5\n");

                _returnVal1Seller.setEnterprise(seller_id);
                while (rs2.next()) {
                	_returnVal1Seller.setName(rs2.getString("full_name"));
                }
                
                sql = "SELECT * FROM ent_address WHERE subject_fk=" + seller_id;
                rs2 = stmt2.executeQuery(sql);
                while (rs2.next()) {
                	ttu.idu0080.orderservice.orders.EntAddress _EntAddress = new ttu.idu0080.orderservice.orders.EntAddress();
                	_EntAddress.setAddress(rs2.getInt("ent_address"));
                	_EntAddress.setCountry(rs2.getString("country"));
                	_EntAddress.setCounty(rs2.getString("county"));
                	_EntAddress.setStreetAddress(rs2.getString("street_address"));
                	_EntAddress.setTownVillage(rs2.getString("town_village"));
                	_EntAddress.setZipcode(rs2.getString("zipcode"));
                	_returnVal1SellerAddresses.add(_EntAddress);
                }
                _returnVal1Seller.getAddresses().addAll(_returnVal1SellerAddresses);
                _returnVal1.setSeller(_returnVal1Seller);

                sql = "SELECT * FROM address WHERE subject_fk=" + ship_id;
                rs2 = stmt2.executeQuery(sql);
                System.out.printf("7\n");
                
                ttu.idu0080.orderservice.orders.Address _returnVal1ShippingAddress = new ttu.idu0080.orderservice.orders.Address();
                while (rs2.next()) {
	                _returnVal1ShippingAddress.setAddress(rs2.getInt("address"));
	                _returnVal1ShippingAddress.setCountry(rs2.getString("country"));
	                _returnVal1ShippingAddress.setCounty(rs2.getString("country"));
	                _returnVal1ShippingAddress.setStreetAddress(rs2.getString("street_address"));
	                _returnVal1ShippingAddress.setTownVillage(rs2.getString("town_village"));
	                _returnVal1ShippingAddress.setZipcode(rs2.getString("zipcode"));
	                _returnVal1.setShippingAddress(_returnVal1ShippingAddress);
                }                
                _return.add(_returnVal1);
            }
            
            return _return;
        } catch (java.lang.Exception ex) {
            ex.printStackTrace();
            throw new RuntimeException(ex);
        }
    }

    /* (non-Javadoc)
     * @see ttu.idu0080.orderservice.orders.OrderService#getOrdersByOrderId(int  orderId )*
     */
    public ttu.idu0080.orderservice.orders.Order getOrdersByOrderId(int orderId) { 
        LOG.info("Executing operation getOrdersByOrderId");
        System.out.println(orderId);
        try {
            ttu.idu0080.orderservice.orders.Order _return = new ttu.idu0080.orderservice.orders.Order();
            ttu.idu0080.orderservice.orders.Customer _returnCustomer = new ttu.idu0080.orderservice.orders.Customer();
            java.util.List<ttu.idu0080.orderservice.orders.Address> _returnCustomerAddresses = new java.util.ArrayList<ttu.idu0080.orderservice.orders.Address>();
            ttu.idu0080.orderservice.orders.Address _returnCustomerAddressesVal1 = new ttu.idu0080.orderservice.orders.Address();
            _returnCustomerAddressesVal1.setAddress(2069865473);
            _returnCustomerAddressesVal1.setCountry("Country954745081");
            _returnCustomerAddressesVal1.setCounty("County-248332771");
            _returnCustomerAddressesVal1.setStreetAddress("StreetAddress2063002218");
            _returnCustomerAddressesVal1.setTownVillage("TownVillage258199816");
            _returnCustomerAddressesVal1.setZipcode("Zipcode-1331342888");
            _returnCustomerAddresses.add(_returnCustomerAddressesVal1);
            _returnCustomer.getAddresses().addAll(_returnCustomerAddresses);
            _returnCustomer.setCustomer(594819841);
            _returnCustomer.setFirstName("FirstName-1840544169");
            _returnCustomer.setLastName("LastName-1766585446");
            _return.setCustomer(_returnCustomer);
            _return.setOrderId(-2057195494);
            java.util.List<ttu.idu0080.orderservice.orders.OrderProduct> _returnOrderProducts = new java.util.ArrayList<ttu.idu0080.orderservice.orders.OrderProduct>();
            ttu.idu0080.orderservice.orders.OrderProduct _returnOrderProductsVal1 = new ttu.idu0080.orderservice.orders.OrderProduct();
            _returnOrderProductsVal1.setOrderProduct(600884169);
            _returnOrderProductsVal1.setPrice(0.8816067f);
            _returnOrderProductsVal1.setPriceTotal(0.20994389f);
            _returnOrderProductsVal1.setProductCount(406104252);
            _returnOrderProductsVal1.setProductName("ProductName1916497140");
            _returnOrderProducts.add(_returnOrderProductsVal1);
            _return.getOrderProducts().addAll(_returnOrderProducts);
            _return.setPriceTotal(0.6670409f);
            ttu.idu0080.orderservice.orders.Seller _returnSeller = new ttu.idu0080.orderservice.orders.Seller();
            java.util.List<ttu.idu0080.orderservice.orders.EntAddress> _returnSellerAddresses = new java.util.ArrayList<ttu.idu0080.orderservice.orders.EntAddress>();
            ttu.idu0080.orderservice.orders.EntAddress _returnSellerAddressesVal1 = new ttu.idu0080.orderservice.orders.EntAddress();
            _returnSellerAddressesVal1.setAddress(1307193818);
            _returnSellerAddressesVal1.setCountry("Country-688535547");
            _returnSellerAddressesVal1.setCounty("County-1874929270");
            _returnSellerAddressesVal1.setStreetAddress("StreetAddress-1851195975");
            _returnSellerAddressesVal1.setTownVillage("TownVillage2083435683");
            _returnSellerAddressesVal1.setZipcode("Zipcode-76760326");
            _returnSellerAddresses.add(_returnSellerAddressesVal1);
            _returnSeller.getAddresses().addAll(_returnSellerAddresses);
            _returnSeller.setEnterprise(-606178941);
            _returnSeller.setName("Name33953300");
            _return.setSeller(_returnSeller);
            ttu.idu0080.orderservice.orders.Address _returnShippingAddress = new ttu.idu0080.orderservice.orders.Address();
            _returnShippingAddress.setAddress(-518571788);
            _returnShippingAddress.setCountry("Country-1374071786");
            _returnShippingAddress.setCounty("County-2132141464");
            _returnShippingAddress.setStreetAddress("StreetAddress-1766584330");
            _returnShippingAddress.setTownVillage("TownVillage-288504661");
            _returnShippingAddress.setZipcode("Zipcode170567482");
            _return.setShippingAddress(_returnShippingAddress);
            return _return;
        } catch (java.lang.Exception ex) {
            ex.printStackTrace();
            throw new RuntimeException(ex);
        }
    }

    /* (non-Javadoc)
     * @see ttu.idu0080.orderservice.orders.OrderService#getOrdersByShippingAddress(java.lang.String  country ,)java.lang.String  county )*
     */
    public java.util.List<ttu.idu0080.orderservice.orders.Order> getOrdersByShippingAddress(java.lang.String country,java.lang.String county) { 
        LOG.info("Executing operation getOrdersByShippingAddress");
        System.out.println(country);
        System.out.println(county);
        try {
            java.util.List<ttu.idu0080.orderservice.orders.Order> _return = new java.util.ArrayList<ttu.idu0080.orderservice.orders.Order>();
            ttu.idu0080.orderservice.orders.Order _returnVal1 = new ttu.idu0080.orderservice.orders.Order();
            ttu.idu0080.orderservice.orders.Customer _returnVal1Customer = new ttu.idu0080.orderservice.orders.Customer();
            java.util.List<ttu.idu0080.orderservice.orders.Address> _returnVal1CustomerAddresses = new java.util.ArrayList<ttu.idu0080.orderservice.orders.Address>();
            _returnVal1Customer.getAddresses().addAll(_returnVal1CustomerAddresses);
            _returnVal1Customer.setCustomer(-1992141254);
            _returnVal1Customer.setFirstName("FirstName1823759403");
            _returnVal1Customer.setLastName("LastName-1547622236");
            _returnVal1.setCustomer(_returnVal1Customer);
            _returnVal1.setOrderId(1312256226);
            java.util.List<ttu.idu0080.orderservice.orders.OrderProduct> _returnVal1OrderProducts = new java.util.ArrayList<ttu.idu0080.orderservice.orders.OrderProduct>();
            ttu.idu0080.orderservice.orders.OrderProduct _returnVal1OrderProductsVal1 = new ttu.idu0080.orderservice.orders.OrderProduct();
            _returnVal1OrderProductsVal1.setOrderProduct(-2080052077);
            _returnVal1OrderProductsVal1.setPrice(0.5873205f);
            _returnVal1OrderProductsVal1.setPriceTotal(0.5940213f);
            _returnVal1OrderProductsVal1.setProductCount(1874410649);
            _returnVal1OrderProductsVal1.setProductName("ProductName7897611");
            _returnVal1OrderProducts.add(_returnVal1OrderProductsVal1);
            _returnVal1.getOrderProducts().addAll(_returnVal1OrderProducts);
            _returnVal1.setPriceTotal(0.38989383f);
            ttu.idu0080.orderservice.orders.Seller _returnVal1Seller = new ttu.idu0080.orderservice.orders.Seller();
            java.util.List<ttu.idu0080.orderservice.orders.EntAddress> _returnVal1SellerAddresses = new java.util.ArrayList<ttu.idu0080.orderservice.orders.EntAddress>();
            _returnVal1Seller.getAddresses().addAll(_returnVal1SellerAddresses);
            _returnVal1Seller.setEnterprise(-1315136860);
            _returnVal1Seller.setName("Name560922286");
            _returnVal1.setSeller(_returnVal1Seller);
            ttu.idu0080.orderservice.orders.Address _returnVal1ShippingAddress = new ttu.idu0080.orderservice.orders.Address();
            _returnVal1ShippingAddress.setAddress(-1508916771);
            _returnVal1ShippingAddress.setCountry("Country252016657");
            _returnVal1ShippingAddress.setCounty("County174564491");
            _returnVal1ShippingAddress.setStreetAddress("StreetAddress-303885016");
            _returnVal1ShippingAddress.setTownVillage("TownVillage1564671433");
            _returnVal1ShippingAddress.setZipcode("Zipcode-1003284417");
            _returnVal1.setShippingAddress(_returnVal1ShippingAddress);
            _return.add(_returnVal1);
            return _return;
        } catch (java.lang.Exception ex) {
            ex.printStackTrace();
            throw new RuntimeException(ex);
        }
    }

    /* (non-Javadoc)
     * @see ttu.idu0080.orderservice.orders.OrderService#getOrdersByCustomerLastName(java.lang.String  lastName )*
     */
    public java.util.List<ttu.idu0080.orderservice.orders.Order> getOrdersByCustomerLastName(java.lang.String lastName) { 
        LOG.info("Executing operation getOrdersByCustomerLastName");
        System.out.println(lastName);
        try {
            java.util.List<ttu.idu0080.orderservice.orders.Order> _return = new java.util.ArrayList<ttu.idu0080.orderservice.orders.Order>();
            ttu.idu0080.orderservice.orders.Order _returnVal1 = new ttu.idu0080.orderservice.orders.Order();
            ttu.idu0080.orderservice.orders.Customer _returnVal1Customer = new ttu.idu0080.orderservice.orders.Customer();
            java.util.List<ttu.idu0080.orderservice.orders.Address> _returnVal1CustomerAddresses = new java.util.ArrayList<ttu.idu0080.orderservice.orders.Address>();
            _returnVal1Customer.getAddresses().addAll(_returnVal1CustomerAddresses);
            _returnVal1Customer.setCustomer(2007201592);
            _returnVal1Customer.setFirstName("FirstName1251730422");
            _returnVal1Customer.setLastName("LastName1065969723");
            _returnVal1.setCustomer(_returnVal1Customer);
            _returnVal1.setOrderId(-1973231694);
            java.util.List<ttu.idu0080.orderservice.orders.OrderProduct> _returnVal1OrderProducts = new java.util.ArrayList<ttu.idu0080.orderservice.orders.OrderProduct>();
            ttu.idu0080.orderservice.orders.OrderProduct _returnVal1OrderProductsVal1 = new ttu.idu0080.orderservice.orders.OrderProduct();
            _returnVal1OrderProductsVal1.setOrderProduct(-794202107);
            _returnVal1OrderProductsVal1.setPrice(0.92671967f);
            _returnVal1OrderProductsVal1.setPriceTotal(0.7408645f);
            _returnVal1OrderProductsVal1.setProductCount(1517433074);
            _returnVal1OrderProductsVal1.setProductName("ProductName1033290147");
            _returnVal1OrderProducts.add(_returnVal1OrderProductsVal1);
            _returnVal1.getOrderProducts().addAll(_returnVal1OrderProducts);
            _returnVal1.setPriceTotal(0.33334535f);
            ttu.idu0080.orderservice.orders.Seller _returnVal1Seller = new ttu.idu0080.orderservice.orders.Seller();
            java.util.List<ttu.idu0080.orderservice.orders.EntAddress> _returnVal1SellerAddresses = new java.util.ArrayList<ttu.idu0080.orderservice.orders.EntAddress>();
            _returnVal1Seller.getAddresses().addAll(_returnVal1SellerAddresses);
            _returnVal1Seller.setEnterprise(489220679);
            _returnVal1Seller.setName("Name-1279371539");
            _returnVal1.setSeller(_returnVal1Seller);
            ttu.idu0080.orderservice.orders.Address _returnVal1ShippingAddress = new ttu.idu0080.orderservice.orders.Address();
            _returnVal1ShippingAddress.setAddress(1621133666);
            _returnVal1ShippingAddress.setCountry("Country-2097791526");
            _returnVal1ShippingAddress.setCounty("County2116015312");
            _returnVal1ShippingAddress.setStreetAddress("StreetAddress1032297992");
            _returnVal1ShippingAddress.setTownVillage("TownVillage-1942129489");
            _returnVal1ShippingAddress.setZipcode("Zipcode2127604966");
            _returnVal1.setShippingAddress(_returnVal1ShippingAddress);
            _return.add(_returnVal1);
            return _return;
        } catch (java.lang.Exception ex) {
            ex.printStackTrace();
            throw new RuntimeException(ex);
        }
    }

}
